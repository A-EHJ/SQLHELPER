@implements IDisposable
@inject SetupState SetupState

<div class="nav-menu">
    <div class="nav-section text-uppercase text-secondary fw-semibold small px-3">Workspace</div>
    <nav class="nav flex-column">
        <NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
            <span class="me-2" aria-hidden="true">📊</span> Dashboard
        </NavLink>
        <NavLink class="nav-link" href="/connect">
            <span class="me-2" aria-hidden="true">🔌</span> Connect
        </NavLink>
        <NavLink class="nav-link" href="/query">
            <span class="me-2" aria-hidden="true">🧩</span> Query runner
        </NavLink>
        <NavLink class="nav-link" href="/library">
            <span class="me-2" aria-hidden="true">📚</span> Library
        </NavLink>
        <NavLink class="nav-link" href="/notes">
            <span class="me-2" aria-hidden="true">📝</span> Notes
        </NavLink>
        @if (SetupState.IsSetupRequired)
        {
            <NavLink class="nav-link text-warning" href="/setup">
                <span class="me-2" aria-hidden="true">⚙️</span> Setup
            </NavLink>
        }
    </nav>
</div>

@code {
    protected override void OnInitialized()
    {
        SetupState.OnChange += OnStateChanged;
    }

    private void OnStateChanged() => InvokeAsync(StateHasChanged);

    public void Dispose()
    {
        SetupState.OnChange -= OnStateChanged;
    }
}
